import{e as p,g as k,c as l,b as V,a as s,h as g,t as u,i as f,j as C,v as M,F as _,k as w,r as D,o as a,d as B,l as j,f as K}from"./index--CBJS0Pd.js";import{a as L,s as N}from"./sweetalert-YiYa1UDA.js";const S={class:"mb-4 flex gap-3"},F={id:"sortMenu",class:"border-2 border-primary bg-white"},q={class:"relative"},A=s("span",{class:"material-symbols-outlined select-none"},"expand_more",-1),E={class:"flex w-full select-none items-center border-2 border-primary bg-white"},T=s("label",{for:"search",class:"hidden"},null,-1),P=s("span",{class:"material-symbols-outlined h-5 w-5"},"search",-1),U=[P],z={class:"flex gap-4"},H=["src"],O={class:"flex flex-col justify-center"},Y={class:"font-bold hover:text-secondary hover:underline hover:decoration-secondary"},G={class:"flex items-center"},I={class:"text-[12px] text-[#9B9893]"},J={class:"material-symbols-outlined ml-2 text-lg text-[#707070]"},Q={class:"my-4"},R={class:"mb-1"},W={class:"flex flex-wrap items-center gap-1 text-secondary"},X=s("span",{class:"material-symbols-outlined select-none text-lg"},"tag",-1),Z=["src"],ee={key:1,class:"rounded-lg border-2 border-primary bg-white",style:{"box-shadow":"0px 3px 0px #000400"}},te=K('<div class="flex items-center gap-[6px] border-b-2 border-primary p-4"><div class="h-[10px] w-[10px] rounded-full border border-[#707070] bg-[#DE4B63]"></div><div class="h-[10px] w-[10px] rounded-full border border-[#707070] bg-[#FAA722]"></div><div class="h-[10px] w-[10px] rounded-full border border-[#707070] bg-[#83C51D]"></div></div><p class="py-8 text-center text-[#9B9893]">目前尚無動態，新增一則貼文吧！</p>',2),se=[te],le={__name:"PostsView",setup(oe){const v=p(!1),i=p("desc"),m=p(""),b=p(!1);function d(o){i.value=o??i.value,b.value=!b.value}const y=p([]);async function n(){var o,e;v.value=!0;try{const r=await L.get(`https://node-training-2024.onrender.com/posts?sort=${i.value}&q=${m.value}`);y.value=r.data.posts}catch(r){m.value="",N({icon:"error",title:((e=(o=r.response)==null?void 0:o.data)==null?void 0:e.message)??r.message??"發生錯誤"})}v.value=!1}function $(o){const e=new Date(o),r=e.getFullYear(),t=e.getMonth()+1,c=e.getDate(),x=e.getHours(),h=e.getMinutes();return`${r}/${t<10?`0${t}`:t}/${c<10?`0${c}`:c} ${x}:${h}`}return k(()=>{n(),document.querySelector("body").addEventListener("click",o=>{o.target.closest("#sortMenu")||(b.value=!1)})}),(o,e)=>{const r=D("VueLoading");return a(),l(_,null,[V(r,{active:v.value,"onUpdate:active":e[0]||(e[0]=t=>v.value=t)},null,8,["active"]),s("div",S,[s("div",F,[s("div",q,[s("div",{class:"flex w-[156px] cursor-pointer items-center justify-between px-4 py-3",onClick:e[1]||(e[1]=t=>d()),onKeyup:e[2]||(e[2]=g(t=>d(),["enter"]))},[s("p",null,u(i.value==="asc"?"由舊至新":"最新貼文"),1),A],32),s("ul",{class:f([{hidden:!b.value},"absolute left-0 right-0 top-14 bg-white outline outline-2 outline-primary"])},[s("li",{class:f(["px-4 py-3",i.value==="desc"?"pointer-events-none bg-secondary text-white":"cursor-pointer hover:bg-gray-100"]),onClick:e[3]||(e[3]=t=>{d("desc"),n()}),onKeyup:e[4]||(e[4]=g(t=>{d("desc"),n()},["enter"]))}," 最新貼文 ",34),s("li",{class:f(["px-4 py-3",i.value==="asc"?"pointer-events-none bg-secondary text-white":"cursor-pointer hover:bg-gray-100"]),onClick:e[5]||(e[5]=t=>{d("asc"),n()}),onKeyup:e[6]||(e[6]=g(t=>{d("asc"),n()},["enter"]))}," 由舊至新 ",34)],2)])]),s("div",E,[T,C(s("input",{id:"search",type:"text",placeholder:"搜尋貼文",class:"focus-visible: block h-full w-full px-4 py-3 outline-none","onUpdate:modelValue":e[7]||(e[7]=t=>m.value=t),onKeyup:e[8]||(e[8]=g(t=>n(),["enter"]))},null,544),[[M,m.value,void 0,{trim:!0}]]),s("button",{type:"button",class:"flex aspect-square h-full items-center justify-center border-l-2 border-primary bg-secondary p-3 text-xl text-white",onClick:e[9]||(e[9]=t=>n())},U)])]),y.value.length>0?(a(!0),l(_,{key:0},w(y.value,t=>{var c;return a(),l("div",{class:"mb-4 rounded-lg border-2 border-primary bg-white p-6",style:{"box-shadow":"0px 3px 0px #000400"},key:t._id},[s("div",z,[s("img",{src:t.user&&t.user.photo!==""?t.user.photo:"/images/user_default.png",alt:"user-photo",class:"h-[45px] w-[45px] rounded-full border-2 border-primary"},null,8,H),s("div",O,[s("p",Y,u((c=t.user)==null?void 0:c.name),1),s("div",G,[s("time",I,u($(t.createdAt)),1),s("span",J,u(t.type==="friend"?"group":"public"),1)])])]),s("div",Q,[s("p",R,u(t.content),1),s("div",W,[(a(!0),l(_,null,w(t.tags,(x,h)=>(a(),l("p",{key:`${x}${h}`,class:"flex items-center"},[X,B(" "+u(x),1)]))),128))])]),t.image?(a(),l("img",{key:0,src:t.image,alt:"post-image",class:"max-w-full rounded-lg border-2 border-primary object-contain"},null,8,Z)):j("",!0)])}),128)):(a(),l("div",ee,se))],64)}}};export{le as default};

import{y as x,h as B,r as m,i as f,b as k,c as A,n as C,l as V,d as P}from"./index-COQyUUYm.js";import{s as d}from"./sweetAlert-BQoRJUAf.js";var z={VITE_API_URL:"https://node-training-2024.onrender.com",BASE_URL:"/node-training-2024-front/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:g,BASE_URL:E}=z,b=x("post",()=>{const u=B(),n=m({});function v(e){n.value={...e},u.push(`/post/edit/${e._id}`)}const o=m([]),w=m("desc"),_=m("");async function $(e){var t,a,r,c;try{e==="all"&&(_.value="");const s=await f.get(`${g}/posts?sort=${w.value}&q=${_.value}`);o.value=s.data.posts,o.value.forEach((i,l)=>{i.user.photo||(o.value[l].user.photo=`${E}images/user_default.png`),i.comments.forEach((p,h)=>{p.user.photo||(o.value[l].comments[h].user.photo=`${E}images/user_default.png`)})})}catch(s){((a=(t=s.response)==null?void 0:t.data)==null?void 0:a.message)==="找不到相關貼文"?o.value=[]:d({icon:"error",title:((c=(r=s.response)==null?void 0:r.data)==null?void 0:c.message)||s.message})}}async function R({form:e,postId:t,postData:a,isNewPost:r}){var p,h;let c="post",s=`${g}/post`,i="新增成功",l="/";r||(c="patch",s+=`/${t}`,i="編輯成功",l=`/post/${t}`);try{await f[c](s,a.value),e.value.resetForm(),d({icon:"success",title:i}),u.push(l)}catch(y){d({icon:"error",title:((h=(p=y.response)==null?void 0:p.data)==null?void 0:h.message)||y.message})}}async function S(e){var t,a;try{await f.delete(`${g}/post/${e}`),await $()}catch(r){d({icon:"error",title:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||r.message})}}return{posts:o,sort:w,keyword:_,getPosts:$,submitPost:R,deletePost:S,goToEditPost:v,editingPostData:n}}),D=P("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),L=P("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),T=[D,L],M={__name:"SpinnerComponent",props:["height","width","color"],setup(u){const n=u;return(v,o)=>(k(),A("svg",{class:C(["mt-[2px] animate-spin",`text-${n.color}`]),style:V(`height: ${n.height}; width:${n.width}`),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},T,6))}};export{M as _,b as p};

import{u as V,r as p,z as k,a as m,b as v,c as x,d as a,w as _,F as E,e as l,i as F,h as U,f as B}from"./index-DgaExn-t.js";import{s as f}from"./sweetAlert-BQQMW04Z.js";const L=l("h2",{class:"mb-9 text-center text-2xl font-bold leading-tight text-primary"},"註冊",-1),N={class:"mb-4"},q={class:"flex border-2 border-primary bg-white px-4 py-3"},C={class:"mb-4"},M={class:"flex border-2 border-primary bg-white px-4 py-3"},R={key:0,class:"mt-1 block text-sm text-danger"},T={class:"mb-4"},$={class:"flex border-2 border-primary bg-white px-4 py-3"},A={class:"mb-8"},P={class:"flex border-2 border-primary bg-white px-4 py-3"},S=["disabled"],O={__name:"SignUp",setup(z){const g=V(),u=p(!1),e=p({});let b="";const r=p(!1);k(()=>e.value.email,i=>{i===b?r.value=!0:r.value=!1});async function w(){var i,s;u.value=!0,r.value=!1;try{const t=await F.post("https://node-training-2024.onrender.com/user/sign_up",e.value),{token:n,expires:d}=t.data;document.cookie=`MetaWallToken=${n}; expires=${new Date(d)}`,f({icon:"success",title:"註冊成功"}),g.push("/")}catch(t){t.response.data.message==="該 email 已被使用過"?(r.value=!0,b=`${e.value.email}`):f({icon:"error",title:((s=(i=t.response)==null?void 0:i.data)==null?void 0:s.message)||t.message})}u.value=!1}return(i,s)=>{const t=m("VueLoading"),n=m("VField"),d=m("ErrorMessage"),h=m("RouterLink"),y=m("VForm");return v(),x(E,null,[a(t,{active:u.value,"onUpdate:active":s[0]||(s[0]=c=>u.value=c)},null,8,["active"]),L,a(y,{ref:"form",onSubmit:w,style:{"font-family":"'Azeret Mono', 'Noto Sans TC', sans"}},{default:_(c=>[l("div",N,[l("div",q,[a(n,{name:"暱稱",rules:"required|min:2",modelValue:e.value.name,"onUpdate:modelValue":s[1]||(s[1]=o=>e.value.name=o),type:"text",placeholder:"請輸入暱稱",class:"block w-full"},null,8,["modelValue"])]),a(d,{name:"暱稱",class:"mt-1 block text-sm text-danger"})]),l("div",C,[l("div",M,[a(n,{name:"Email",rules:"required|email",modelValue:e.value.email,"onUpdate:modelValue":s[2]||(s[2]=o=>e.value.email=o),type:"email",placeholder:"請輸入 Email",class:"block w-full"},null,8,["modelValue"])]),a(d,{name:"Email",class:"mt-1 block text-sm text-danger"}),!c.errors.Email&&r.value?(v(),x("span",R," 帳號已被註冊，請替換新的 Email！ ")):U("",!0)]),l("div",T,[l("div",$,[a(n,{name:"密碼",rules:"required|password",modelValue:e.value.password,"onUpdate:modelValue":s[3]||(s[3]=o=>e.value.password=o),type:"password",placeholder:"請輸入密碼",class:"block w-full"},null,8,["modelValue"])]),a(d,{name:"密碼",class:"mt-1 block text-sm text-danger"})]),l("div",A,[l("div",P,[a(n,{name:"確認密碼",rules:{required:!0,same:["密碼",e.value.password]},modelValue:e.value.confirmPassword,"onUpdate:modelValue":s[4]||(s[4]=o=>e.value.confirmPassword=o),type:"password",placeholder:"確認密碼",class:"block w-full"},null,8,["rules","modelValue"])]),a(d,{name:"確認密碼",class:"mt-1 block text-sm text-danger"})]),l("button",{type:"submit",class:"block w-full rounded-lg border-2 border-primary bg-secondary py-4 text-white shadow-[-2px_2px_0px_#000400] disabled:border-[#808080] disabled:bg-[#A8B0B9] disabled:shadow-none sm:px-[130px]",disabled:Object.keys(c.errors).length!==0||!e.value.name||!e.value.email||!e.value.password||!e.value.confirmPassword||r.value}," 註冊 ",8,S),a(h,{to:"/sign/in",class:"hover: block py-4 text-center underline-offset-8 hover:underline"},{default:_(()=>[B(" 登入 ")]),_:1})]),_:1},512)],64)}}};export{O as default};

import{e as m,c as p,b as l,w as F,F as k,a as e,r as b,o as v,d as g,k as $,l as B,j as f,m as _}from"./index-BiABSmpQ.js";import{a as j,s as w,b as q}from"./sweetalert-Ce9kuSur.js";const L=e("div",{class:"relative mb-3 h-[64px]"},[e("h2",{class:"absolute bottom-0 left-0 right-0 top-0 z-10 border-2 border-primary bg-white py-[18px] text-center text-xl font-bold"}," 張貼動態 "),e("div",{class:"absolute bottom-[-4px] left-[-4px] right-1 top-1 z-0 border-2 border-primary bg-white py-[18px] text-center text-xl font-bold"})],-1),N={class:"mb-4"},z=e("label",{for:"content",class:"mb-1 block"},[g(" 貼文內容 "),e("span",{class:"text-danger"},"*")],-1),E={class:"mb-4"},I=e("p",{class:"mb-1 mr-2"},[g(" 類型 "),e("span",{class:"text-danger"},"*")],-1),S={class:"mb-[2px] flex items-center gap-2"},D={for:"friend",class:"flex items-center gap-1"},M={for:"public",class:"flex items-center gap-1"},O={class:"mb-6"},P=e("label",{for:"tags",class:"mb-1 block"},"標籤（選填）",-1),T={class:"mr-2 flex select-none flex-wrap items-center gap-2"},A=e("span",{class:"material-symbols-outlined ml-2 select-none"},"tag",-1),G=["onClick"],H={key:0,class:"mt-1 flex items-center text-sm text-danger"},J={class:"mb-4"},K={class:"mb-4"},Q=e("button",{type:"button",class:"rounded bg-primary px-8 py-1 text-center text-white hover:bg-goldenrod hover:text-primary"}," 上傳圖片 ",-1),R=e("span",{class:"mx-3"},"或是",-1),W={class:"mt-3 flex border-2 border-primary px-4 py-2"},X={class:"relative"},Y=["src"],Z=["disabled"],oe={__name:"CreatePost",setup(ee){const u=m(!1),t=m({user:"6608ed1d2846fccc562fcde1",content:"",type:"",tags:[],image:""}),r=m(!1);function x(n){n==="open"?r.value=!0:t.value.image===""?r.value=!1:q({icon:"warning",title:"確定要刪除圖片嗎",text:"此操作將無法復原",onConfirm(){t.value.image="",r.value=!1}})}const h=m(null);async function C(){var n,s;u.value=!0;try{await j.post("https://node-training-2024.onrender.com/post ",t.value),h.value.resetForm(),w({icon:"success",title:"新增貼文成功"})}catch(c){w({icon:"error",title:((s=(n=c.response)==null?void 0:n.data)==null?void 0:s.message)??c.message??"發生錯誤"})}u.value=!1}return(n,s)=>{const c=b("VueLoading"),i=b("VField"),y=b("ErrorMessage"),U=b("VForm");return v(),p(k,null,[l(c,{active:u.value,"onUpdate:active":s[0]||(s[0]=a=>u.value=a)},null,8,["active"]),L,l(U,{ref_key:"form",ref:h,onSubmit:C,class:"border-2 border-primary bg-white p-8"},{default:F(a=>[e("div",N,[z,l(i,{id:"content",name:"貼文內容",placeholder:"輸入您的貼文內容",class:"min-h-[169px] w-full border-2 border-primary px-3 py-4",modelValue:t.value.content,"onUpdate:modelValue":s[1]||(s[1]=o=>t.value.content=o),style:{resize:"none"},rules:"required",as:"textarea"},null,8,["modelValue"]),l(y,{name:"貼文內容",class:"block text-sm text-danger"})]),e("div",E,[I,e("div",S,[e("label",D,[l(i,{name:"類型",rules:"required",id:"friend",type:"radio",value:"friend",modelValue:t.value.type,"onUpdate:modelValue":s[2]||(s[2]=o=>t.value.type=o)},null,8,["modelValue"]),g(" 好友 ")]),e("label",M,[l(i,{name:"類型",rules:"required",id:"public",type:"radio",value:"public",modelValue:t.value.type,"onUpdate:modelValue":s[3]||(s[3]=o=>t.value.type=o)},null,8,["modelValue"]),g(" 公開 ")])]),l(y,{name:"類型",class:"block text-sm text-danger"})]),e("div",O,[P,e("div",T,[(v(!0),p(k,null,$(t.value.tags,(o,d)=>(v(),p("div",{key:d,class:"relative flex max-w-fit items-center rounded border-2 border-primary"},[A,l(i,{rules:"required",type:"text",id:"tags",name:`標籤 ${d}`,modelValue:t.value.tags[d],"onUpdate:modelValue":V=>t.value.tags[d]=V,value:o,placeholder:"標籤內容",class:"w-[100px] py-1 pl-1 pr-3"},null,8,["name","modelValue","onUpdate:modelValue","value"]),e("button",{type:"button",class:"material-symbols-outlined absolute right-1 ml-1",onClick:V=>t.value.tags.splice(d,1)}," close ",8,G)]))),128)),e("button",{type:"button",class:"material-symbols-outlined h-8 w-8 rounded-full bg-primary p-1 text-base text-white hover:bg-goldenrod hover:text-primary",onClick:s[4]||(s[4]=o=>t.value.tags.push(""))}," add ")]),a.errors&&Object.keys(a.errors).find(o=>/標籤/i.test(o))?(v(),p("p",H," 標籤欄位不得為空 ")):B("",!0)]),e("div",J,[e("div",K,[Q,R,e("button",{type:"button",class:"border-b-2 border-primary hover:border-secondary hover:text-secondary",onClick:s[5]||(s[5]=o=>x("open"))}," 輸入網址 "),f(e("div",W,[l(i,{name:"圖片網址",rules:"url",modelValue:t.value.image,"onUpdate:modelValue":s[6]||(s[6]=o=>t.value.image=o),type:"text",placeholder:"請輸入圖片網址",class:"block w-full"},null,8,["modelValue"]),e("button",{type:"button",class:"material-symbols-outlined ml-1",onClick:s[7]||(s[7]=o=>x("close"))}," close ")],512),[[_,r.value]]),l(y,{name:"圖片網址",class:"mt-1 block text-sm text-danger"})]),f(e("div",X,[e("img",{src:t.value.image,alt:"post-image",class:"mb-8 object-contain"},null,8,Y),f(e("button",{type:"button",class:"material-symbols-outlined absolute right-0 top-0 p-4",onClick:s[8]||(s[8]=o=>x("close"))}," close ",512),[[_,!r.value]])],512),[[_,t.value.image&&!a.errors.圖片網址]])]),e("button",{type:"submit",class:"mx-auto block rounded-lg border-2 border-primary bg-goldenrod px-[130px] py-4 disabled:bg-[#A8B0B9] disabled:text-primary",style:{"box-shadow":"-2px 2px 0px #000400"},disabled:Object.keys(a.errors).length!==0||t.value.content===""||t.value.type===""||t.value.tags.find(o=>o==="")}," 送出貼文 ",8,Z)]),_:1},512)],64)}}};export{oe as default};
